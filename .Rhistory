ggp <- ggplot(balt.NEI,aes(factor(year),Emissions,fill=type)) +
geom_line(stat="identity") +
theme_bw() + guides(fill=FALSE)+
facet_grid(.~type,scales = "free",space="free") +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (Tons)")) +
labs(title=expression("PM"[2.5]*" Emissions, Baltimore City 1999-2008 by Source Type"))
print(ggp)
ggp <- ggplot(balt.NEI,aes(factor(year),Emissions,fill=type)) +
geom_smooth(stat="identity") +
theme_bw() + guides(fill=FALSE)+
facet_grid(.~type,scales = "free",space="free") +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (Tons)")) +
labs(title=expression("PM"[2.5]*" Emissions, Baltimore City 1999-2008 by Source Type"))
print(ggp)
a <- ggplot(data = totData, aes(x = year, y = V1, group = type, color = type)) +
geom_line() +
xlab("Year") +
ylab("PPM2.5") +
ggtitle("Total PM2.5")
print(a)
totData
a <- ggplot(balt.NEI, aes(factor(year), Emissions, color = type)) +
geom_line() +
xlab("Year") +
ylab("PPM2.5") +
ggtitle("Total PM2.5")
print(a)
balt.NEI
types.balt <- ddply(NEI[NEI$fips == "24510",], c("year", "type"), function(df)sum(df$Emissions, na.rm = TRUE))
ggplot(types.balt, aes(x = year, y = V1, group = type, color = type)) +
geom_line() +
xlab("Year") +
ylab("PPM2.5") +
ggtitle("Total PM2.5")
types.balt <- ddply(NEI[NEI$fips == "24510",], c("year", "type"), function(df)sum(df$Emissions, na.rm = TRUE))
ggplot(types.balt, aes(x = year, y = V1, group = type, color = type)) +
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~"(tons)")) +
ggtitle(expression("Total PM"[2.5]~ "Emissions per Year by Source Type"))
# Total emissions for Baltimore grouped by types of sources
types.balt <- ddply(NEI[NEI$fips == "24510",], c("year", "type"), function(df)sum(df$Emissions, na.rm = TRUE))
# Open the graphics device
png(filename = "figures/plot3.png", width = 480, height = 480, units = "px")
# Plot the data and label the graph
ggplot(types.balt, aes(x = year, y = V1, group = type, color = type)) +
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~"(tons)")) +
ggtitle(expression("Total PM"[2.5]~ "Emissions per Year by Source Type"))
# Close the graphics device
dev.off()
coal.sources <- SCC[grep("^Coal ", SCC$Short.Name, ignore.case=F),"SCC"]
head(coal.sources)
aggData <- ddply(NEI[NEI$SCC %in% coalSources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
aggData <- ddply(NEI[NEI$SCC %in% coal.sources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
head(aggData)
# Filter out all Coal related source names from SCC Table
coal.sources <- SCC[grep("^Coal ", SCC$Short.Name, ignore.case=F),"SCC"]
# Now filter out all related emission sources for all the above Coal Sources
coal.data <- ddply(NEI[NEI$SCC %in% coal.sources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
#Open graphics device
png(filename="figure/plot4.png", width=480, height=480)
#Plot final data to plot which of the 4 sources have seen decreased emissions
ggplot(coal.data, aes(x=Year,y=Emissions))+
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
#shutdown device
dev.off()
# Filter out all Coal related source names from SCC Table
coal.sources <- SCC[grep("^Coal ", SCC$Short.Name, ignore.case=F),"SCC"]
# Now filter out all related emission sources for all the above Coal Sources
coal.data <- ddply(NEI[NEI$SCC %in% coal.sources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
#Open graphics device
png(filename="figure/plot4.png", width=480, height=480)
#Plot final data to plot which of the 4 sources have seen decreased emissions
ggplot(coal.data, aes(x = year,y = Emissions))+
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
#shutdown device
dev.off()
head(NEI)
#Open graphics device
png(filename="figure/plot4.png", width=480, height=480)
#Plot final data to plot which of the 4 sources have seen decreased emissions
ggplot(coal.data, aes(x = "year", y = "Emissions"))+
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
#shutdown device
dev.off()
b <-   geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
b <- ggplot(coal.data, aes(x = "year", y = "Emissions"))+
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
print(b)
# Filter out all Coal related source names from SCC Table
coal.sources <- SCC[grep("^Coal ", SCC$Short.Name, ignore.case=F),"SCC"]
# Now filter out all related emission sources for all the above Coal Sources
coal.data <- ddply(NEI[NEI$SCC %in% coal.sources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
b <- ggplot(coal.data, aes(x = "year", y = "Emissions"))+
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
print(b)
#Filter out all Coal related source names from SCC Table
coalSources <- SCC[grep("^Coal ", SCC$Short.Name, ignore.case=F),"SCC"]
#Now filter out all related emission sources for all the above Coal Sources
aggData <- ddply(NEI[NEI$SCC %in% coalSources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
#Change column names for this aggregated data to something meaningful
names(aggData) <- c('Year', 'Emissions')
#Open graphics device
png(filename="figure/plot4.png", width=480, height=480)
#Plot final data to plot which of the 4 sources have seen decreased emissions
ggplot(aggData, aes(x=Year,y=Emissions))+
geom_line()+
xlab('Year')+
ylab('Total PM2.5 Emissions (tons)')+
ggtitle('Total Emissions Trend from Coal Combustion-related sources')
#shutdown device
dev.off()
# Filter out all Coal related source names from SCC Table
coal.sources <- SCC[grep("^Coal ", SCC$Short.Name, ignore.case=F),"SCC"]
# Now filter out all related emission sources for all the above Coal Sources
coal.data <- ddply(NEI[NEI$SCC %in% coal.sources,], c("year"),
function(df)sum(df$Emissions, na.rm=TRUE))
#Open graphics device
png(filename="figures/plot4.png", width=480, height=480)
#Plot final data to plot which of the 4 sources have seen decreased emissions
ggplot(coal.data, aes(x = "year", y = "Emissions"))+
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~ "Emissions (tons)")) +
ggtitle(expression("PM"[2.5]~ "Emissions from Coal-Related Sources"))
#shutdown device
dev.off()
coal.data
# Subset coal combustion related NEI data
combustion.related <- grepl("comb", SCC$SCC.Level.One, ignore.case=TRUE)
coal.related <- grepl("coal", SCC$SCC.Level.Four, ignore.case=TRUE)
coal.combustion <- (combustion.related & coal.related)
combustion.SCC <- SCC[coal.combustion,]$SCC
combustion.NEI <- NEI[NEI$SCC %in% combustion.SCC,]
ggp <- ggplot(combustionNEI,aes(factor(year),Emissions/10^5)) +
geom_bar(stat="identity",fill="grey",width=0.75) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggp <- ggplot(combustion.NEI,aes(factor(year),Emissions/10^5)) +
geom_line() +
theme_bw() +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggp <- ggplot(combustion.NEI,aes(factor(year),Emissions/10^5)) +
geom_bar(stat="identity",fill="grey",width=0.75) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggp <- ggplot(combustion.NEI,aes(factor(year),Emissions/10^5)) +
geom_line(stat="identity",fill="grey",width=0.75) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggp <- ggplot(combustion.NEI,aes(factor(year),Emissions/10^5)) +
geom_bar(stat="identity",fill="grey",width=0.75) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggp <- ggplot(combustion.NEI) +
geom_line(aes(factor(year), Emissions)) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
aggData
combustion.NEI
head(combustion.NEI)
ggp <- ggplot(aggData) +
geom_line(aes(factor(year), Emissions)) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggp <- ggplot(aggData) +
geom_line(aes(factor(Year), Emissions)) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (10^5 Tons)")) +
labs(title=expression("PM"[2.5]*" Coal Combustion Source Emissions Across US from 1999-2008"))
print(ggp)
ggplot(combustion.NEI) +
geom_line(aes(factor(year), Emissions)) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across US from 1999-2008"))
ggplot(combustion.NEI,aes(factor(year),Emissions) +
geom_bar(stat = "identity", fill = "grey", width = 0.75) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across US from 1999-2008"))
d
ggplot(combustion.NEI,aes(factor(year),Emissions) +
geom_bar(stat = "identity", fill = "grey", width = 0.75) +
theme_bw() +  guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across US from 1999-2008"))
)
ggplot(combustion.NEI,aes(factor(year),Emissions)) +
geom_bar(stat = "identity", fill = "grey", width = 0.75) +
theme_bw() +
guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across US from 1999-2008"))
# Subset coal combustion related NEI data
combustion.related <- grepl("comb", SCC$SCC.Level.One, ignore.case=TRUE)
coal.related <- grepl("coal", SCC$SCC.Level.Four, ignore.case=TRUE)
coal.combustion <- (combustion.related & coal.related)
combustion.SCC <- SCC[coal.combustion,]$SCC
combustion.NEI <- NEI[NEI$SCC %in% combustion.SCC,]
#Open graphics device
png(filename="figures/plot4.png", width=480, height=480)
# Plot the subsetted data to show which sources have had decreased emissions
ggplot(combustion.NEI,aes(factor(year),Emissions)) +
geom_bar(stat = "identity", fill = "grey", width = 0.75) +
theme_bw() +
guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across US from 1999-2008"))
#shutdown device
dev.off()
png(filename="figures/plot4.png", width=480, height=480)
# Plot the subsetted data to show which sources have had decreased emissions
ggplot(combustion.NEI,aes(factor(year),Emissions)) +
geom_bar(stat = "identity", width = 0.75) +
theme_bw() +
guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across US from 1999-2008"))
#shutdown device
dev.off()
#Open graphics device
png(filename="figures/plot4.png", width=480, height=480)
# Plot the subsetted data to show which sources have had decreased emissions
ggplot(combustion.NEI,aes(factor(year),Emissions)) +
geom_bar(stat = "identity", width = 0.75) +
theme_bw() +
guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across the US"))
#shutdown device
dev.off()
NEI.on-road <- NEI[(NEI$fips == "24510") & (NEI$type == "ON-ROAD"),]
NEI.on.road <- NEI[(NEI$fips == "24510") & (NEI$type == "ON-ROAD"),]
head(NEI.on.road)
agg.MV.balt <- aggregate(NEI.on.road$Emissions, list(Year=NEI.on.road$year), sum)
head(agg.MV.balt)
agg.MV.balt$x <- agg.MV.balt$x/1000
head(agg.MV.balt)
agg.MV.balt <- aggregate(NEI.on.road$Emissions, list(Year=NEI.on.road$year), sum)
#Subsetting on Baltimore and "on-road" Type
NEI.on.road <- NEI[(NEI$fips == "24510") & (NEI$type == "ON-ROAD"),]
#Filter out from all emissions on above criteria and calculate aggregate
agg.MV.balt <- aggregate(NEI.on.road$Emissions, list(Year=NEI.on.road$year), sum)
#Open graphics device
png(filename = "figures/plot5.png", width = 480, height = 480, units = "px")
#Plotting the details to answer how emissions changed from motor vecicle sources
ggplot(agg.MV.balt) +
geom_line(aes(y = x, x = Year)) +
labs(y=expression("PM"[2.5]~ "Emission (tons)")) +
ggtitle(expression(atop("Total PM"[2.5]~ "Emission from Motor Vehicle Sources",
atop(italic("Baltimore City, Maryland"), ""))))
#shutdown device
dev.off()
#Open graphics device
png(filename = "figures/plot5.png", width = 480, height = 480, units = "px")
#Plotting the details to answer how emissions changed from motor vecicle sources
ggplot(agg.MV.balt) +
geom_line(aes(y = x, x = Year)) +
labs(y=expression("PM"[2.5]~ "Emission (tons)")) +
ggtitle(expression(atop("Total PM"[2.5]~ "Emission from Motor Vehicle Sources",
atop(italic("Baltimore City, Maryland")))))
#shutdown device
dev.off()
#Subsetting on Baltimore and "on-road" type
NEI.OR.balt <- NEI[(NEI$fips == "24510") & (NEI$type == "ON-ROAD"),]
#Filter out from all emissions on above criteria and calculate aggregate
agg.MV.balt <- aggregate(NEI.OR.balt$Emissions, list(Year=NEI.OR.balt$year), sum)
#Open graphics device
png(filename = "figures/plot5.png", width = 480, height = 480, units = "px")
#Plotting the details to answer how emissions changed from motor vecicle sources
ggplot(agg.MV.balt) +
geom_line(aes(y = x, x = Year)) +
labs(y=expression("PM"[2.5]~ "Emission (tons)")) +
ggtitle(expression(atop("Total PM"[2.5]~ "Emission from Motor Vehicle Sources",
atop(italic("Baltimore City, Maryland")))))
#shutdown device
dev.off()
#Subsetting on Baltimore and LA with "on-road" type
NEI.OR.Balt_LA <- NEI[(NEI$fips %in% c("24510","06037")) & (NEI$type=="ON-ROAD"), ]
#Filter out from all emissions on above criteria and calculate aggregate
agg.MV.Balt_LA <- aggregate(NEI.OR.Balt_LA$Emissions, list(Year=NEI.OR.Balt_LA$year,
Location=as.factor(NEI.OR.Balt_LA$fips)), sum)
# Subset on Baltimore and LA with "on-road" type
NEI.OR.Balt_LA <- NEI[(NEI$fips %in% c("24510","06037")) & (NEI$type=="ON-ROAD"), ]
# Filter out from all emissions on above criteria and calculate aggregate
agg.MV.Balt_LA <- aggregate(NEI.OR.Balt_LA$Emissions, list(Year = NEI.OR.Balt_LA$year,
Location = as.factor(NEI.OR.Balt_LA$fips)), sum)
# Calculate which city has seen greater changes in motor vehicle emissions
MVE.change <- ddply(agg.MV.Balt_LA, "Location", transform, Growth=c(0, (exp(diff(log(x))) - 1) * 100))
# Substitute the fips code back to respective cities to make sense in graph
MVE.change <- as.data.frame(sapply(MVE.change,gsub,pattern="06037",replacement="Los Angeles"))
MVE.change <- as.data.frame(sapply(MVE.change,gsub,pattern="24510",replacement="Baltimore"))
ggplot(MVE.change, aes(Year, Growth, fill = Location)) +
geom_bar(position = "dodge", stat="identity") +
labs(y="Variation (in %)") +
ggtitle(expression(atop(" variation of emission of PM2.5",
atop(italic("from motor vehicle sources"), ""))))
ggplot(MVE.change, aes(Year, Growth, fill = Location)) +
geom_bar(position = "dodge", stat="identity") +
labs(y="Variation (in %)") +
ggtitle(expression(atop("Variation in Motor Vehicle Emission of PM"[2.5],
atop(italic("Baltimore City, MD; Los Angelas, CA"), ""))))
MVE.change
# Subset on motor vehicles
vehicles <- grepl("vehicle", SCC$SCC.Level.Two, ignore.case = TRUE)
vehicles.SCC <- SCC[vehicles,]$SCC
vehicles.NEI <- NEI[NEI$SCC %in% vehicles.SCC,]
# Subset on just motor vehicles from Baltimore and LA
vehicles.balt.NEI <- vehicles.NEI[vehicles.NEI$fips == 24510,]
vehicles.balt.NEI$city <- "Baltimore City"
vehicles.LA.NEI <- vehicles.NEI[vehicles.NEI$fips=="06037",]
vehicles.LA.NEI$city <- "Los Angeles County"
both.NEI <- rbind(vehicles.balt.NEI,vehicles.LA.NEI)
ggplot(both.NEI, aes(x = factor(year), y = Emissions, fill = city)) +
geom_bar(aes(fill = year),stat = "identity") +
facet_grid(scales = "free", space = "free", .~city) +
guides(fill = FALSE) + theme_bw() +
labs(x = "Year", y=expression("Total PM"[2.5]~ "Emission (kTons)")) +
labs(title=expression("PM"[2.5]~ "Motor Vehicle Source Emissions in Baltimore & LA, 1999-2008"))
vehicles.balt.NEI <- vehicles.NEI[vehicles.NEI$fips == 24510,]
vehicles.balt.NEI$city <- "Baltimore City"
vehicles.LA.NEI <- vehicles.NEI[vehicles.NEI$fips=="06037",]
vehicles.LA.NEI$city <- "Los Angeles California"
both.NEI <- rbind(vehicles.balt.NEI,vehicles.LA.NEI)
vehicles.balt.NEI <- vehicles.NEI[vehicles.NEI$fips == 24510,]
vehicles.balt.NEI$city <- "Baltimore City"
vehicles.LA.NEI <- vehicles.NEI[vehicles.NEI$fips=="06037",]
vehicles.LA.NEI$city <- "Los Angeles California"
both.NEI <- rbind(vehicles.balt.NEI,vehicles.LA.NEI)
ggplot(both.NEI, aes(x = factor(year), y = Emissions, fill = city)) +
geom_bar(aes(fill = year),stat = "identity") +
facet_grid(scales = "free", space = "free", .~city) +
guides(fill = FALSE) + theme_bw() +
labs(x = "Year", y=expression("Total PM"[2.5]~ "Emission (kTons)")) +
labs(title=expression("PM"[2.5]~ "Motor Vehicle Source Emissions", atop(italics("Baltimore City, MD and Los Angeles County, CA"))))
ggplot(both.NEI, aes(x = factor(year), y = Emissions, fill = city)) +
geom_bar(aes(fill = year),stat = "identity") +
facet_grid(scales = "free", space = "free", .~city) +
guides(fill = FALSE) + theme_bw() +
labs(x = "Year", y=expression("Total PM"[2.5]~ "Emission (kTons)")) +
labs(title=expression("PM"[2.5]~ "Motor Vehicle Source Emissions", atop(italics("Baltimore City, MD and Los Angeles County, CA"))))
ggplot(both.NEI, aes(x = factor(year), y = Emissions, fill = city)) +
geom_bar(aes(fill = year),stat = "identity") +
facet_grid(scales = "free", space = "free", .~city) +
guides(fill = FALSE) + theme_bw() +
labs(x = "Year", y=expression("Total PM"[2.5]~ "Emission (kTons)")) +
ggtitle(expression(atop("PM"[2.5]~ "Emission from Motor Vehicle Sources", atop(italic("Baltimore City, MD and Los Angeles County, CA")))))
# Subset on motor vehicles
vehicles <- grepl("vehicle", SCC$SCC.Level.Two, ignore.case = TRUE)
vehicles.SCC <- SCC[vehicles,]$SCC
vehicles.NEI <- NEI[NEI$SCC %in% vehicles.SCC,]
# Subset on just motor vehicles from Baltimore and LA
vehicles.balt.NEI <- vehicles.NEI[vehicles.NEI$fips == 24510,]
vehicles.balt.NEI$city <- "Baltimore City"
vehicles.LA.NEI <- vehicles.NEI[vehicles.NEI$fips=="06037",]
vehicles.LA.NEI$city <- "Los Angeles"
both.NEI <- rbind(vehicles.balt.NEI,vehicles.LA.NEI)
#Open the graphics device
png(filename = "figures/plot6.png", width = 480, height = 480, units = "px")
# Plot the amounts of emissions in Baltimore and LA
ggplot(both.NEI, aes(x = factor(year), y = Emissions, fill = city)) +
geom_bar(aes(fill = year),stat = "identity") +
facet_grid(scales = "free", space = "free", .~city) +
guides(fill = FALSE) + theme_bw() +
labs(x = "Year", y=expression("Total PM"[2.5]~ "Emission (kTons)")) +
ggtitle(expression(atop("PM"[2.5]~ "Emission from Motor Vehicle Sources", atop(italic("Baltimore City, MD and Los Angeles County, CA")))))
#shutting down the device
dev.off()
# Get the aggregate total of emissions by year
agg.totals <- aggregate(Emissions ~ year, NEI, sum)
# Open the graphics device
png(filename = "figures/plot1.png", width = 480, height = 480, units = "px")
# Construct the plot (setting margins before hand for labeling purposes)
par(mar = c(5.1, 6.1, 4.1, 4.1))
plot(agg.totals, type = "l", col = "red", xlab = "", ylab = "", xaxt = "n")
# Label the plot and make it look pretty
title(main = expression("Total PM"[2.5]~ "Emissions from All US Sources"),
col.main = "black",
xlab = "Year",
ylab = expression("Total PM"[2.5]~ "Emissions (tons)"),
cex.main = 1.75,
cex.lab = 1.5
)
## Replaces original, vague x-axis labels with ones corresponding to the data
axis(1, at=as.integer(agg.totals$year), las=1)
#Close the graphic device
dev.off()
#Get the aggregate total emissions for Baltimore
balt.NEI <- NEI[NEI$fips == "24510",]
#Break it down by year
agg.totals.balt <- aggregate(Emissions ~ year, balt.NEI, sum)
# Open the graphics device
png(filename = "figures/plot2.png", width = 480, height = 480, units = "px")
# Construct the plot (setting margins before hand for labeling purposes)
par(mar = c(5.1, 6.1, 4.1, 4.1))
plot(agg.totals.balt, type = "l", col = "red", xlab = "", ylab = "", xaxt = "n")
# Label the plot and make it look pretty
title(main = expression("Total PM"[2.5]~ "Emissions from Baltimore City, MD"),
col.main = "black",
xlab = "Year",
ylab = expression("Total PM"[2.5]~ "Emissions (tons)"),
cex.main = 1.75,
cex.lab = 1.5
)
## Replaces original, vague x-axis labels with ones corresponding to the data
axis(1, at=as.integer(agg.totals.balt$year), las=1)
#Close the graphic device
dev.off()
# Total emissions for Baltimore grouped by types of sources
types.balt <- ddply(NEI[NEI$fips == "24510",], c("year", "type"), function(df)sum(df$Emissions, na.rm = TRUE))
# Open the graphics device
png(filename = "figures/plot3.png", width = 480, height = 480, units = "px")
# Plot the data and label the graph
ggplot(types.balt, aes(x = year, y = V1, group = type, color = type)) +
geom_line() +
xlab("Year") +
ylab(expression("PM"[2.5]~"(tons)")) +
ggtitle(expression("Total PM"[2.5]~ "Emissions per Year by Source Type"))
# Close the graphics device
dev.off()
# Subset coal combustion related NEI data
combustion.related <- grepl("comb", SCC$SCC.Level.One, ignore.case=TRUE)
coal.related <- grepl("coal", SCC$SCC.Level.Four, ignore.case=TRUE)
coal.combustion <- (combustion.related & coal.related)
combustion.SCC <- SCC[coal.combustion,]$SCC
combustion.NEI <- NEI[NEI$SCC %in% combustion.SCC,]
#Open graphics device
png(filename="figures/plot4.png", width=480, height=480, units = "px")
# Plot the subsetted data to show which sources have had decreased emissions
ggplot(combustion.NEI,aes(factor(year),Emissions)) +
geom_bar(stat = "identity", width = 0.75) +
theme_bw() +
guides(fill=FALSE) +
labs(x="year", y=expression("Total PM"[2.5]~ "Emissions (tons)")) +
labs(title=expression("PM"[2.5]~"Coal Combustion Source Emissions Across the US"))
#shutdown device
dev.off()
#Subsetting on Baltimore and "on-road" type
NEI.OR.balt <- NEI[(NEI$fips == "24510") & (NEI$type == "ON-ROAD"),]
#Filter out from all emissions on above criteria and calculate aggregate
agg.MV.balt <- aggregate(NEI.OR.balt$Emissions, list(Year=NEI.OR.balt$year), sum)
#Open graphics device
png(filename = "figures/plot5.png", width = 480, height = 480, units = "px")
#Plotting the details to answer how emissions changed from motor vecicle sources
ggplot(agg.MV.balt) +
geom_line(aes(y = x, x = Year)) +
labs(y=expression("PM"[2.5]~ "Emission (tons)")) +
ggtitle(expression(atop("Total PM"[2.5]~ "Emission from Motor Vehicle Sources", atop(italic("Baltimore City, MD")))))
#shutdown device
dev.off()
# Subset on motor vehicles
vehicles <- grepl("vehicle", SCC$SCC.Level.Two, ignore.case = TRUE)
vehicles.SCC <- SCC[vehicles,]$SCC
vehicles.NEI <- NEI[NEI$SCC %in% vehicles.SCC,]
# Subset on just motor vehicles from Baltimore and LA
vehicles.balt.NEI <- vehicles.NEI[vehicles.NEI$fips == 24510,]
vehicles.balt.NEI$city <- "Baltimore City"
vehicles.LA.NEI <- vehicles.NEI[vehicles.NEI$fips=="06037",]
vehicles.LA.NEI$city <- "Los Angeles"
both.NEI <- rbind(vehicles.balt.NEI,vehicles.LA.NEI)
#Open the graphics device
png(filename = "figures/plot6.png", width = 480, height = 480, units = "px")
# Plot the amounts of emissions in Baltimore and LA
ggplot(both.NEI, aes(x = factor(year), y = Emissions, fill = city)) +
geom_bar(aes(fill = year),stat = "identity") +
facet_grid(scales = "free", space = "free", .~city) +
guides(fill = FALSE) + theme_bw() +
labs(x = "Year", y=expression("Total PM"[2.5]~ "Emission (kTons)")) +
ggtitle(expression(atop("PM"[2.5]~ "Emission from Motor Vehicle Sources", atop(italic("Baltimore City, MD and Los Angeles County, CA")))))
#shutting down the device
dev.off()
